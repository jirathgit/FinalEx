# FinalEx

Node-red Data Alchemist

![alt text](https://raw.githubusercontent.com/jirathgit/FinalEx/master/FinalEx_data/overview.png)

Sort
```
var foosort = msg.medical_people.sort((a,b) => a.sickness_level - b.sickness_level);
msg.payload = foosort;
return msg;
```

Maping
```
var mapfoo = msg.medical_people.map(o => {
            var strclass = "";
            if(o.sickness_level == 1){
                strclass = 'Well';
            }
            else if(o.sickness_level == 2){
                strclass = 'Not Well';
            }
            else if(o.sickness_level == 3){
                strclass = 'Not Very Well';
            }
            var new_object = {
                First_Name: o.name.split(" ")[0],
                Last_name: o.name.split(" ")[1],
                age: o.age,
                gender: o.gender,
                medical_candition: o.medical_candition,
                sickness_level: o.sickness_level,
                class: strclass
            };
            return new_object;
        })
msg.payload = mapfoo;
return msg;
```
Filter
```
var test = msg.medical_people.filter(o=> o.age > 30);
msg.payload = test;
return msg;
```


```
[{"id":"fda10469.155a78","type":"http in","z":"523a23e2.90980c","name":"","url":"/map","method":"get","upload":false,"swaggerDoc":"","x":180,"y":160,"wires":[["e02aec94.e8c2e"]]},{"id":"e02aec94.e8c2e","type":"function","z":"523a23e2.90980c","name":"data","func":"var medical_people = [\n            {name: 'Maxf last',age: 22, gender: 'm', medical_candition: ['normal','normal','normal'], sickness_level:1},\n            {name: 'Maxf last',age: 29, gender: 'm', medical_candition: ['normal','normal','normal'], sickness_level:2},\n            {name: 'Maxf last',age: 22, gender: 'm', medical_candition: ['normal','normal','normal'], sickness_level:2},\n            {name: 'Maxf last',age: 31, gender: 'm', medical_candition: ['normal','normal','can not sleep'], sickness_level:3},\n            {name: 'Maxf last',age: 33, gender: 'm', medical_candition: ['can not sleep','normal','normal'], sickness_level:3}\n        ];\nmsg.medical_people = medical_people;\nreturn msg;","outputs":1,"noerr":0,"x":370,"y":180,"wires":[["6cbd8548.b8b33c"]]},{"id":"2a43128f.0c8d9e","type":"http response","z":"523a23e2.90980c","name":"","statusCode":"","headers":{},"x":670,"y":160,"wires":[]},{"id":"6cbd8548.b8b33c","type":"function","z":"523a23e2.90980c","name":"map","func":"var mapfoo = msg.medical_people.map(o => {\n            var strclass = \"\";\n            if(o.sickness_level == 1){\n                strclass = 'Well';\n            }\n            else if(o.sickness_level == 2){\n                strclass = 'Not Well';\n            }\n            else if(o.sickness_level == 3){\n                strclass = 'Not Very Well';\n            }\n            var new_object = {\n                First_Name: o.name.split(\" \")[0],\n                Last_name: o.name.split(\" \")[1],\n                age: o.age,\n                gender: o.gender,\n                medical_candition: o.medical_candition,\n                sickness_level: o.sickness_level,\n                class: strclass\n            };\n            return new_object;\n        })\nmsg.payload = mapfoo;\nreturn msg;","outputs":1,"noerr":0,"x":510,"y":160,"wires":[["2a43128f.0c8d9e"]]},{"id":"bad4202b.2b48b","type":"function","z":"523a23e2.90980c","name":"sort","func":"var foosort = msg.medical_people.sort((a,b) => a.sickness_level - b.sickness_level);\nmsg.payload = foosort;\nreturn msg;","outputs":1,"noerr":0,"x":530,"y":240,"wires":[["8dd292a5.5ef8a"]]},{"id":"2c0da62d.7a0b0a","type":"http in","z":"523a23e2.90980c","name":"","url":"/sort","method":"get","upload":false,"swaggerDoc":"","x":190,"y":240,"wires":[["deda929e.7e804"]]},{"id":"deda929e.7e804","type":"function","z":"523a23e2.90980c","name":"data","func":"var medical_people = [\n            {name: 'Maxf last',age: 22, gender: 'm', medical_candition: ['normal','normal','normal'], sickness_level:1},\n            {name: 'Maxf last',age: 29, gender: 'm', medical_candition: ['normal','normal','normal'], sickness_level:2},\n            {name: 'Maxf last',age: 22, gender: 'm', medical_candition: ['normal','normal','normal'], sickness_level:2},\n            {name: 'Maxf last',age: 31, gender: 'm', medical_candition: ['normal','normal','can not sleep'], sickness_level:3},\n            {name: 'Maxf last',age: 33, gender: 'm', medical_candition: ['can not sleep','normal','normal'], sickness_level:3}\n        ];\nmsg.medical_people = medical_people;\nreturn msg;","outputs":1,"noerr":0,"x":370,"y":240,"wires":[["bad4202b.2b48b"]]},{"id":"8dd292a5.5ef8a","type":"http response","z":"523a23e2.90980c","name":"","statusCode":"","headers":{},"x":670,"y":220,"wires":[]},{"id":"c38d3d45.4a0f8","type":"function","z":"523a23e2.90980c","name":"filter","func":"var test = msg.medical_people.filter(o=> o.age > 30);\nmsg.payload = test;\nreturn msg;","outputs":1,"noerr":0,"x":550,"y":320,"wires":[["ce0a787d.3d0028"]]},{"id":"a3322f62.2d247","type":"http in","z":"523a23e2.90980c","name":"","url":"/filter","method":"get","upload":false,"swaggerDoc":"","x":210,"y":320,"wires":[["31a6b6e5.5b6f6a"]]},{"id":"31a6b6e5.5b6f6a","type":"function","z":"523a23e2.90980c","name":"data","func":"var medical_people = [\n            {name: 'Maxf last',age: 22, gender: 'm', medical_candition: ['normal','normal','normal'], sickness_level:1},\n            {name: 'Maxf last',age: 29, gender: 'm', medical_candition: ['normal','normal','normal'], sickness_level:2},\n            {name: 'Maxf last',age: 22, gender: 'm', medical_candition: ['normal','normal','normal'], sickness_level:2},\n            {name: 'Maxf last',age: 31, gender: 'm', medical_candition: ['normal','normal','can not sleep'], sickness_level:3},\n            {name: 'Maxf last',age: 33, gender: 'm', medical_candition: ['can not sleep','normal','normal'], sickness_level:3}\n        ];\nmsg.medical_people = medical_people;\nreturn msg;","outputs":1,"noerr":0,"x":390,"y":320,"wires":[["c38d3d45.4a0f8"]]},{"id":"ce0a787d.3d0028","type":"http response","z":"523a23e2.90980c","name":"","statusCode":"","headers":{},"x":690,"y":300,"wires":[]},{"id":"33f76ac8.727a06","type":"inject","z":"523a23e2.90980c","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":280,"y":520,"wires":[["e0ffce44.a578e"]]},{"id":"e0ffce44.a578e","type":"http request","z":"523a23e2.90980c","name":"","method":"GET","ret":"txt","url":"https://www.settrade.com/C04_02_stock_historical_p1.jsp?txtSymbol={{name}}","tls":"","x":430,"y":460,"wires":[["6abc3c39.2b58a4"]]},{"id":"25a03926.f81a56","type":"debug","z":"523a23e2.90980c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":670,"y":520,"wires":[]},{"id":"4e299a61.3db2c4","type":"function","z":"523a23e2.90980c","name":"","func":"var result = {stock:msg.name,data:[]};\nvar datetime;\nvar price_close;\n\nfor(var i = 0; i < 12; i++ ){\n    datetime = msg.payload[0+(i*12)];\n    price_close = msg.payload[5+(i*12)];\n    \n    result.data.unshift({datetime:datetime,price_close:price_close});\n}\nmsg.payload = result;\nreturn msg;","outputs":1,"noerr":0,"x":650,"y":460,"wires":[["25a03926.f81a56","d2307e67.96c37"]]},{"id":"5af9c153.defde","type":"http in","z":"523a23e2.90980c","name":"","url":"/stocks","method":"get","upload":false,"swaggerDoc":"","x":130,"y":440,"wires":[["cae86b31.414498"]]},{"id":"d2307e67.96c37","type":"http response","z":"523a23e2.90980c","name":"","statusCode":"","headers":{},"x":830,"y":460,"wires":[]},{"id":"cae86b31.414498","type":"function","z":"523a23e2.90980c","name":"","func":"var stock_name = msg.payload.name;\nmsg.name = stock_name;\nreturn msg;","outputs":1,"noerr":0,"x":290,"y":420,"wires":[["e0ffce44.a578e"]]},{"id":"6abc3c39.2b58a4","type":"html","z":"523a23e2.90980c","name":"","property":"payload","outproperty":"payload","tag":"div.col-xs-12>div.table-responsive>table.table.table-info.table-hover>tbody>tr>td","ret":"html","as":"single","x":690,"y":400,"wires":[["4e299a61.3db2c4"]]},{"id":"f9582770.ad5ae8","type":"http in","z":"523a23e2.90980c","name":"","url":"/searchstock","method":"get","upload":false,"swaggerDoc":"","x":150,"y":360,"wires":[["7b7f9277.c86d7c"]]},{"id":"7b7f9277.c86d7c","type":"function","z":"523a23e2.90980c","name":"data+fill","func":"var stock_name = msg.payload.name;\nvar stockList = [\"2S\",\"A\",\"AAV\",\"ABC\",\"ABICO\",\"ACAP\",\"ACC\",\"ADAM\",\"ADVANC\",\"AEC\",\"AEONTS\",\"AF\",\"AFC\",\"AGE\",\"AH\",\"AHC\",\"AI\",\"AIE\",\"AIRA\",\"AIT\",\"AJ\",\"AJD\",\"AKP\",\"AKR\",\"ALLA\",\"ALT\",\"ALUCON\",\"AMA\",\"AMANAH\",\"AMARIN\",\"AMATA\",\"AMATAV\",\"AMC\",\"ANAN\",\"AOT\",\"AP\",\"APCO\",\"APCS\",\"APURE\",\"AQ\",\"AQUA\",\"ARIP\",\"ARROW\",\"AS\",\"ASEFA\",\"ASIA\",\"ASIAN\",\"ASIMAR\",\"ASK\",\"ASN\",\"ASP\",\"ATP30\",\"AU\",\"AUCT\",\"AYUD\",\"BA\",\"BAFS\",\"BANPU\",\"BAT-3K\",\"BAY\",\"BBL\",\"BCH\",\"BCP\",\"BCPG\",\"BDMS\",\"BEAUTY\",\"BEC\",\"BEM\",\"BFIT\",\"BGT\",\"BH\",\"BIG\",\"BIGC\",\"BIZ\",\"BJC\",\"BJCHI\",\"BKD\",\"BKI\",\"BLA\",\"BLAND\",\"BLISS\",\"BM\",\"BOL\",\"BPP\",\"BR\",\"BROCK\",\"BROOK\",\"BRR\",\"BSBM\",\"BSM\",\"BTC\",\"BTNC\",\"BTS\",\"BTW\",\"BUI\",\"BWG\",\"CBG\",\"CCET\",\"CCN\",\"CCP\",\"CEN\",\"CENTEL\",\"CFRESH\",\"CGD\",\"CGH\",\"CHARAN\",\"CHEWA\",\"CHG\",\"CHO\",\"CHOTI\",\"CHOW\",\"CHUO\",\"CI\",\"CIG\",\"CIMBT\",\"CITY\",\"CK\",\"CKP\",\"CM\",\"CMO\",\"CMR\",\"CNS\",\"CNT\",\"COL\",\"COLOR\",\"COM7\",\"COMAN\",\"CPALL\",\"CPF\",\"CPH\",\"CPI\",\"CPL\",\"CPN\",\"CPR\",\"CRANE\",\"CSC\",\"CSL\",\"CSP\",\"CSR\",\"CSS\",\"CTW\",\"CWT\",\"DAII\",\"DCC\",\"DCON\",\"DCORP\",\"DELTA\",\"DEMCO\",\"DIMET\",\"DNA\",\"DRACO\",\"DRT\",\"DSGT\",\"DTAC\",\"DTC\",\"DTCI\",\"EA\",\"EARTH\",\"EASON\",\"EASTW\",\"ECF\",\"ECL\",\"EE\",\"EFORL\",\"EGCO\",\"EIC\",\"EKH\",\"EMC\",\"EPCO\",\"EPG\",\"ERW\",\"ESSO\",\"ESTAR\",\"EVER\",\"F&D\",\"FANCY\",\"FC\",\"FE\",\"FER\",\"FMT\",\"FN\",\"FNS\",\"FOCUS\",\"FORTH\",\"FPI\",\"FSMART\",\"FSS\",\"FVC\",\"GBX\",\"GC\",\"GCAP\",\"GEL\",\"GENCO\",\"GFPT\",\"GIFT\",\"GJS\",\"GL\",\"GLAND\",\"GLOBAL\",\"GLOW\",\"GOLD\",\"GPSC\",\"GRAMMY\",\"GRAND\",\"GREEN\",\"GSTEL\",\"GTB\",\"GUNKUL\",\"GYT\",\"HANA\",\"HARN\",\"HFT\",\"HMPRO\",\"HOTPOT\",\"HPT\",\"HTC\",\"HTECH\",\"HYDRO\",\"ICC\",\"ICHI\",\"IEC\",\"IFEC\",\"IFS\",\"IHL\",\"ILINK\",\"INET\",\"INOX\",\"INSURE\",\"INTUCH\",\"IRC\",\"IRCP\",\"IRPC\",\"IT\",\"ITD\",\"ITEL\",\"IVL\",\"J\",\"JAS\",\"JCT\",\"JMART\",\"JMT\",\"JSP\",\"JTS\",\"JUBILE\",\"JUTHA\",\"JWD\",\"K\",\"KAMART\",\"KASET\",\"KBANK\",\"KBS\",\"KC\",\"KCAR\",\"KCE\",\"KCM\",\"KDH\",\"KGI\",\"KIAT\",\"KKC\",\"KKP\",\"KOOL\",\"KSL\",\"KTB\",\"KTC\",\"KTIS\",\"KWC\",\"KWG\",\"KYE\",\"L&E\",\"LALIN\",\"LANNA\",\"LDC\",\"LEE\",\"LH\",\"LHBANK\",\"LHK\",\"LIT\",\"LOXLEY\",\"LPH\",\"LPN\",\"LRH\",\"LST\",\"LTX\",\"LVT\",\"M\",\"M-CHAI\",\"MACO\",\"MAJOR\",\"MAKRO\",\"MALEE\",\"MANRIN\",\"MATCH\",\"MATI\",\"MAX\",\"MBAX\",\"MBK\",\"MBKET\",\"MC\",\"MCOT\",\"MCS\",\"MDX\",\"MEGA\",\"METCO\",\"MFC\",\"MFEC\",\"MIDA\",\"MILL\",\"MINT\",\"MJD\",\"MK\",\"ML\",\"MODERN\",\"MONO\",\"MOONG\",\"MPG\",\"MPIC\",\"MSC\",\"MTI\",\"MTLS\",\"NBC\",\"NC\",\"NCH\",\"NCL\",\"NDR\",\"NEP\",\"NETBAY\",\"NEW\",\"NEWS\",\"NINE\",\"NKI\",\"NMG\",\"NNCL\",\"NOBLE\",\"NOK\",\"NPK\",\"NPP\",\"NSI\",\"NTV\",\"NUSA\",\"NWR\",\"NYT\",\"OCC\",\"OCEAN\",\"OGC\",\"OHTL\",\"OISHI\",\"ORI\",\"OTO\",\"PACE\",\"PAE\",\"PAF\",\"PAP\",\"PATO\",\"PB\",\"PCA\",\"PCSGH\",\"PDG\",\"PDI\",\"PE\",\"PERM\",\"PF\",\"PG\",\"PHOL\",\"PICO\",\"PIMO\",\"PJW\",\"PK\",\"PL\",\"PLANB\",\"PLAT\",\"PLE\",\"PM\",\"PMTA\",\"POLAR\",\"POST\",\"PPM\",\"PPP\",\"PPS\",\"PR\",\"PRAKIT\",\"PRANDA\",\"PREB\",\"PRECHA\",\"PRG\",\"PRIN\",\"PRINC\",\"PRO\",\"PSH\",\"PSL\",\"PSTC\",\"PT\",\"PTG\",\"PTL\",\"PTT\",\"PTTEP\",\"PTTGC\",\"PYLON\",\"Q-CON\",\"QH\",\"QLT\",\"QTC\",\"RAM\",\"RATCH\",\"RCI\",\"RCL\",\"RICH\",\"RICHY\",\"RJH\",\"RML\",\"ROBINS\",\"ROCK\",\"ROH\",\"ROJNA\",\"RP\",\"RPC\",\"RS\",\"RWI\",\"S&J\",\"S\",\"S11\",\"SABINA\",\"SALEE\",\"SAM\",\"SAMART\",\"SAMCO\",\"SAMTEL\",\"SANKO\",\"SAPPE\",\"SAT\",\"SAUCE\",\"SAWAD\",\"SAWANG\",\"SC\",\"SCB\",\"SCC\",\"SCCC\",\"SCG\",\"SCI\",\"SCN\",\"SCP\",\"SE-ED\",\"SEAFCO\",\"SEAOIL\",\"SELIC\",\"SENA\",\"SF\",\"SFP\",\"SGF\",\"SGP\",\"SHANG\",\"SIAM\",\"SIM\",\"SIMAT\",\"SINGER\",\"SIRI\",\"SIS\",\"SITHAI\",\"SKR\",\"SLP\",\"SMART\",\"SMIT\",\"SMK\",\"SMM\",\"SMPC\",\"SMT\",\"SNC\",\"SNP\",\"SOLAR\",\"SORKON\",\"SPA\",\"SPACK\",\"SPALI\",\"SPC\",\"SPCG\",\"SPG\",\"SPI\",\"SPORT\",\"SPPT\",\"SPRC\",\"SPVI\",\"SQ\",\"SR\",\"SRICHA\",\"SSC\",\"SSF\",\"SSI\",\"SSSC\",\"SST\",\"STA\",\"STANLY\",\"STAR\",\"STEC\",\"STHAI\",\"STPI\",\"SUC\",\"SUPER\",\"SUSCO\",\"SUTHA\",\"SVH\",\"SVI\",\"SVOA\",\"SWC\",\"SYMC\",\"SYNEX\",\"SYNTEC\",\"T\",\"TACC\",\"TAE\",\"TAKUNI\",\"TAPAC\",\"TASCO\",\"TBSP\",\"TC\",\"TCAP\",\"TCB\",\"TCC\",\"TCCC\",\"TCJ\",\"TCMC\",\"TCOAT\",\"TEAM\",\"TF\",\"TFD\",\"TFG\",\"TFI\",\"TGCI\",\"TGPRO\",\"TH\",\"THAI\",\"THANA\",\"THANI\",\"THCOM\",\"THE\",\"THIP\",\"THL\",\"THRE\",\"THREL\",\"TIC\",\"TICON\",\"TIP\",\"TIPCO\",\"TISCO\",\"TIW\",\"TK\",\"TKN\",\"TKS\",\"TKT\",\"TLUXE\",\"TM\",\"TMB\",\"TMC\",\"TMD\",\"TMI\",\"TMILL\",\"TMT\",\"TMW\",\"TNDT\",\"TNH\",\"TNITY\",\"TNL\",\"TNP\",\"TNPC\",\"TNR\",\"TOG\",\"TOP\",\"TOPP\",\"TPA\",\"TPAC\",\"TPBI\",\"TPC\",\"TPCH\",\"TPCORP\",\"TPIPL\",\"TPOLY\",\"TPP\",\"TR\",\"TRC\",\"TRITN\",\"TRT\",\"TRU\",\"TRUBB\",\"TRUE\",\"TSC\",\"TSE\",\"TSF\",\"TSI\",\"TSR\",\"TSTE\",\"TSTH\",\"TTA\",\"TTCL\",\"TTI\",\"TTL\",\"TTTM\",\"TTW\",\"TU\",\"TUCC\",\"TVD\",\"TVI\",\"TVO\",\"TVT\",\"TWP\",\"TWPC\",\"TWZ\",\"TYCN\",\"U\",\"UAC\",\"UBIS\",\"UEC\",\"UKEM\",\"UMI\",\"UMS\",\"UNIQ\",\"UOBKH\",\"UP\",\"UPA\",\"UPF\",\"UPOIC\",\"UREKA\",\"UT\",\"UTP\",\"UV\",\"UVAN\",\"UWC\",\"VARO\",\"VGI\",\"VIBHA\",\"VIH\",\"VNG\",\"VNT\",\"VPO\",\"VTE\",\"WACOAL\",\"WAVE\",\"WG\",\"WHA\",\"WICE\",\"WIIK\",\"WIN\",\"WINNER\",\"WORK\",\"XO\",\"YCI\",\"YNP\",\"YUASA\",\"ZMICO\"];\n\nif(stockList.length > 0){\n    stockList = stockList.filter(o => o.includes(stock_name));\n}\n\nmsg.payload = stockList;\nreturn msg;","outputs":1,"noerr":0,"x":400,"y":360,"wires":[["7924cc02.7ead84"]]},{"id":"7924cc02.7ead84","type":"http response","z":"523a23e2.90980c","name":"","statusCode":"","headers":{},"x":630,"y":360,"wires":[]},{"id":"bf1d518c.77b19","type":"function","z":"523a23e2.90980c","name":"","func":"var type = msg.payload.type;\nvar input = msg.payload.input;\nvar result;\nfunction ValidateEmail(mail) \n{\n if (/^\\w+([\\.-]?\\w+)*@\\w+([\\.-]?\\w+)*(\\.\\w{2,3})+$/.test(mail))\n  {\n    return \"Correct\"\n  }\n    \n    return \"Incorrect\"\n}\n\nfunction ValidateDomain(mail) \n{\n if (/^[a-zA-Z0-9][a-zA-Z0-9-]{0,61}[a-zA-Z0-9](?:\\.[a-zA-Z]{2,})+$/.test(mail))\n  {\n    return \"Correct\"\n  }\n    \n    return \"Incorrect\"\n}\n\nfunction ValidateZip(mail) \n{\n if (/^[0-9]{6}$/.test(mail))\n  {\n    return \"Correct\"\n  }\n    \n    return \"Incorrect\"\n}\nif(type == 'email'){\n    result = ValidateEmail(input);\n}\nif(type == 'domain'){\n    result = ValidateDomain(input);\n}\nif(type == 'zip'){\n    result = ValidateZip(input);\n}\nmsg.payload = {result};\nreturn msg;","outputs":1,"noerr":0,"x":430,"y":580,"wires":[["536dc17b.b9c3a"]]},{"id":"11fb8a55.be5f56","type":"http in","z":"523a23e2.90980c","name":"","url":"/vaild","method":"get","upload":false,"swaggerDoc":"","x":140,"y":580,"wires":[["bf1d518c.77b19"]]},{"id":"536dc17b.b9c3a","type":"http response","z":"523a23e2.90980c","name":"","statusCode":"","headers":{},"x":630,"y":580,"wires":[]}]
```

